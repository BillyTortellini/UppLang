// Next Up: Bytecode generator
fib_iter :: (n:int) -> int
{
    prev := 1;
    curr := 1;
    i := 2;
    while (i < n)
    {
        old := curr;
        curr = prev + curr; 
        prev = old;
        i=i+1;
    }
    return curr;
}

fib :: (n:int) -> int
{
    if (n <= 2)  return 1; 
    return fib(n-1) + fib(n-2);
}

test_2 :: (n:int) -> int
{
    return n * 2;
}

test_1 :: (n:int) -> int
{
    x := 5;
    x = test_2(n);
    y := 3;
    z := n;
    z = z + y;
    return x + y + z;
}

fac_it :: (n:int) -> int 
{
    res := 1;
    x := 2;
    while (x <= n) {
        res = res * x; 
        x = x+1;
    }
    return res;
}

main :: () -> int
{
    i := 0;
    res := 0;
    while (i < 1000000) 
    {
        i = i+1;
        fac_it(20);
    }
    return res;
}


/*  
    Missing binary statements x++; x--; x+=1; x-=1; x/=1; x*=1;
    Short circuit operation on && and ||

    Next Features:
     * Pointers + Arrays 
     * Structs
     * Strings?
     * OS-Calls/Calls to libraries (print, new/delete)
     * Bytecode Debugger?
     * Backend?

    UppLang small improvements:
     * Just highlight relevant stuff on parser errors

    Current UppLang features:
     * Expression parsing + evaluation
     * Variable definition/assignment + return
     * Primitive Type System (Int bool float)
     * Scopes
     * If-Else Flow control
     * While loop with break continue
     * Functions with parameters and return types

    Nice-to-have Features:
     * Log to window, not to console, maybe something like in a textfield
        -> Would be best with a toast like notification, and something you can focus
     * Work on GUI (Probably necessary for better debugging)

    Editor-Bugs:
     * Repeat last search does not differentiate 'f'/'t'/forward backward
     * 'r' is buggy on line end, and on empty lines
     * Undo-Redo cursor position still sucks a little (Hint: Save positions after/before command)
     * Non ASCII chars destroy some motions (Program crashes)
     * Alt-Gr spamming still cancels commands (win32 nonsense)
     * % does not jump on empty parenthesis () {}
     * O does not work on first line
     * dd with numbers seems to not take the last number
     * put with 'dd'ed lines is also a bit weird

    Editor features missing:
     * Correct Indentation on new line
     * Undo/Redo Tree History
     * Visual Mode
     * Visual Block/Multi-Cursor stuff
     * Command recording (@ stuff with vim, altough this could maybe be done better)
*/